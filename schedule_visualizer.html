<html>
<head>
<title>HackEPS 2022</title>
</head>

<h1>Origen studio challenge: Job Shop Problem</h1>
<div id="container">
    <div style="width: 20%; float: left">
        <select id="input" onchange="changeInput()"></select>
    </div>

    <div style="width: 70%; float: right; text-align: left">
        <form>
        <button type="button" onclick="createShedule()">Create new schedule</button>
    </form>
    </div>
</div>

<br></br>

<div>
    <div>
        <div style="border:3px solid #000000; overflow-x: auto; width: 70%; float: left;">
            <table id="scheduleTable"></table>
        </div>
        <div style="border:3px solid #000000; width: 28%; float: right;">
            <table id="legend"></table>
        </div>    
    </div>
</div>

<br></br>
<div>
    <form>
        <button type="button" onclick="computeSchedule()">Compute schedule</button>
    </form>    
</div>

<script type="text/javascript" src="computation.js"></script>
<script type="text/javascript" src="drawSchedule.js"></script>

<script type="text/javascript">

// const fs = require('fs');

// let filesChallenge1 = fs.readdirSync('./input/challenge_1/');
// let filesChallenge2 = fs.readdirSync('input\\challenge_2/');

const reader = new FileReader();
alert(reader.readAsDataURL("input/challenge_1/"))

fillInputSelection();

function fillInputSelection() {
    addOptGroup("Challenge 1", filesChallenge1);
    addOptGroup("Challenge 2", filesChallenge2);

    let label = document.createElement("label");
    label.innerHTML = "Choose the input json: "
    label.htmlFor = "input";
    let select = document.getElementById('input');

    let spacer = document.createElement("label");
    spacer.innerHTML = "Holaa: "
    spacer.htmlFor = "label";

    document.getElementById("container").appendChild(label).appendChild(select);
}

function addOptGroup(labelName, files) {
    let select = document.getElementById('input');

    let optgroup = document.createElement("OPTGROUP");
    optgroup.label = labelName;

    for (const file of files) {
        let opt = document.createElement("option");
        opt.value = file;
        opt.text = file;
        optgroup.appendChild(opt);
    }
    select.appendChild(optgroup);
}

function changeInput() {
    // Paint something that represents the current problem
    let select = document.getElementById('input');
    let challenge = (+ (select.selectedIndex >= filesChallenge1.length)) + 1;
    console.log("Challenge:", challenge, "file:", select.value);
    // drawCanvas(); // Redraw
}

function computeSchedule() {
    // Compute schedule and paint it
    let select = document.getElementById('input');
    let challenge = (+ (select.selectedIndex >= filesChallenge1.length)) + 1;
    let path = "challenge_" + challenge + "/" + select.value;

    let outputJSON = [];
    if (challenge == 1) {
        outputJSON = computeChallenge1(path);
    }
    else {
        outputJSON = computeChallenge2(path);
    }

    drawSchedule(outputJSON);
    console.log(outputJSON);
}

</script>
</html>